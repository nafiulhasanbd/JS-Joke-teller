const button = document.getElementById('button');
const audio = document.getElementById('audio');
const jokeText = document.getElementById('joke');

// Voice API
"use strict";var VoiceRSS={speech:function(e){this._validate(e),this._request(e)},_validate:function(e){if(!e)throw"The settings are undefined";if(!e.key)throw"The API key is undefined";if(!e.src)throw"The text is undefined";if(!e.hl)throw"The language is undefined";if(e.c&&"auto"!=e.c.toLowerCase()){var a=!1;switch(e.c.toLowerCase()){case"mp3":a=(new Audio).canPlayType("audio/mpeg").replace("no","");break;case"wav":a=(new Audio).canPlayType("audio/wav").replace("no","");break;case"aac":a=(new Audio).canPlayType("audio/aac").replace("no","");break;case"ogg":a=(new Audio).canPlayType("audio/ogg").replace("no","");break;case"caf":a=(new Audio).canPlayType("audio/x-caf").replace("no","")}if(!a)throw"The browser does not support the audio codec "+e.c}},_request:function(e){var a=this._buildRequest(e),t=this._getXHR();t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){if(0==t.responseText.indexOf("ERROR"))throw t.responseText;new Audio(t.responseText).play()}},t.open("POST","https://api.voicerss.org/",!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.send(a)},_buildRequest:function(e){var a=e.c&&"auto"!=e.c.toLowerCase()?e.c:this._detectCodec();return"key="+(e.key||"")+"&src="+(e.src||"")+"&hl="+(e.hl||"")+"&v="+(e.v||"")+"&r="+(e.r||"")+"&c="+(a||"")+"&f="+(e.f||"")+"&ssml="+(e.ssml||"")+"&b64=true"},_detectCodec:function(){var e=new Audio;return e.canPlayType("audio/mpeg").replace("no","")?"mp3":e.canPlayType("audio/wav").replace("no","")?"wav":e.canPlayType("audio/aac").replace("no","")?"aac":e.canPlayType("audio/ogg").replace("no","")?"ogg":e.canPlayType("audio/x-caf").replace("no","")?"caf":""},_getXHR:function(){try{return new XMLHttpRequest}catch(e){}try{return new ActiveXObject("Msxml3.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw"The browser does not support HTTP request"}};

// Joke API
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.JokeAPI=t():e.JokeAPI=t()}(self,(function(){return(()=>{var e={824:(e,t,n)=>{"use strict";n.d(t,{Qe:()=>r.JokesRequestOptions,CP:()=>I,L6:()=>R,n5:()=>y,C5:()=>A,sV:()=>h,pD:()=>S,Vb:()=>L,oZ:()=>p});var r={};n.r(r),n.d(r,{s:()=>h});var o=n(300),a=n.n(o);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return n}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e){return["",null,void 0].includes(e)?e:e[0].toUpperCase()+e.slice(1).toLowerCase()},l=function(e){var t,n=[null,void 0,""],r={},o=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=u(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}(Object.entries(e).filter((function(e){var t=i(e,2),r=(t[0],t[1]);return!n.includes(r)})));try{for(o.s();!(t=o.n()).done;){var a=i(t.value,2),s=a[0],c=a[1];r[s]=c}}catch(e){o.e(e)}finally{o.f()}return r},f=n(210);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=e[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"/"!==e.charAt(0)&&(e="/"+e),e.endsWith("/")&&(e=e.slice(0,-1));var n=l(t),r=f.H.API_BASE+e;return 0!==Object.keys(n).length&&(r+="?"+Object.entries(n).map((function(e){var t=d(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)})).join("&")),console.log("Sending request",r),a()(r)}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p("formats",e)}var m,b=function(e){return"number"!=typeof e};function v(e){for(var t=["amount","categories","blacklistFlags","idRange","jokeType","language","responseFormat","searchString"],n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];if(!t.includes(o))return{code:f.X.UNKNOWN_OPTION,description:"'".concat(o,"' is not an available option")}}if(void 0!==e.amount){if(e.amount>10&&console.warn("Provided 'amount' value is higher than 10. JokeAPI's maximum 'amount' is 10."),e.amount<1)return{code:f.X.INVALID_OPTION_VALUE,description:"`amount` can't be less than 1"};if(!Number.isSafeInteger(e.amount))return{code:f.X.INVALID_OPTION_VALUE,description:"'amount' must be an integer"}}if(e.blacklistFlags&&!function(e,t,n){if(0===e.length)return!0;if(!["all","some"].includes("all"))throw new Error("Condition can be 'all' or 'some'");var r=e.map((function(e){return t=e.toString(),f.H.AVAILABLE_FLAGS.includes(t);var t}));return!r.includes(!1)}(e.blacklistFlags))return{code:f.X.INVALID_OPTION_VALUE,description:"All values inside 'flags' array have to be a valid flag value."};if(e.idRange&&b(e.idRange)){if(Math.min(e.idRange.from,e.idRange.to)<0)return{code:f.X.INVALID_OPTION_VALUE,description:"`idRange` values must be a non-negative number"};if(e.idRange.from>e.idRange.to)return{code:f.X.INVALID_OPTION_VALUE,description:"in `idRange`, `from` value must be smaller `to` value"}}return null}function O(e){var t={amount:e.amount,lang:e.language,format:e.responseFormat,contains:e.searchString,type:"any"!==e.jokeType?e.jokeType:void 0,blackListFlags:e.blacklistFlags&&e.blacklistFlags.join(",")};return e.idRange&&b(e.idRange)&&(t.idRange="".concat(e.idRange.from,"-").concat(e.idRange.to)),t}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"number"==typeof e.idRange&&(e.idRange={from:e.idRange,to:e.idRange});var t=v(e);if(t)throw t;var n=e.categories instanceof Array&&0!==e.categories.length?e.categories.map(c).join(","):"Any";return p("/joke/".concat(n),O(e))}function A(e){return p("/info",e)}function I(e){return p("/categories",e)}function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e){if(void 0===e||void 0===e.languageName)throw{code:f.X.UNDEFINED_REQUIRED_VALUE,description:"getLangCode: options.languageName can't be undefined"};return p("/langcode/".concat(e.languageName),E(E({},e),{},{languageName:void 0}))}function L(e){return p("/languages",e)}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p("/flags",e)}!function(e){e[e.amount=1]="amount",e.language="en",e.responseFormat="json",e.categories="Any",e.jokeType="any",e.searchString=""}(m||(m={}))},809:(e,t,n)=>{"use strict";n.r(t),n.d(t,{JokesRequestOptions:()=>r.Qe,getCategories:()=>r.CP,getFlags:()=>r.L6,getFormats:()=>r.n5,getInfo:()=>r.C5,getJokes:()=>r.sV,getLangCode:()=>r.pD,getLanguages:()=>r.Vb,makeRequestToApi:()=>r.oZ,ErrorMessages:()=>i.X,VALUES:()=>i.H});var r=n(824),o=n(606),a={};for(const e in o)["default","JokesRequestOptions","getCategories","getFlags","getFormats","getInfo","getJokes","getLangCode","getLanguages","makeRequestToApi"].indexOf(e)<0&&(a[e]=()=>o[e]);n.d(t,a);var i=n(210)},606:()=>{},210:(e,t,n)=>{"use strict";var r;n.d(t,{X:()=>r,H:()=>o}),function(e){e[e.INVALID_OPTION_VALUE=0]="INVALID_OPTION_VALUE",e[e.UNDEFINED_REQUIRED_VALUE=1]="UNDEFINED_REQUIRED_VALUE",e[e.UNKNOWN_OPTION=2]="UNKNOWN_OPTION"}(r||(r={}));var o={API_BASE:"https://sv443.net/jokeapi/v2",AVAILABLE_FLAGS:["nsfw","religious","political","racist","sexist"],AVAILABLE_CATEGORIES:["Programming","Miscellaneous","Dark","Pun","Spooky","Christmas"]}},300:(e,t)=>{"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(809)})()}));

function test(){
   
}

function tellJoke(joke){
    console.log("tell me", joke);
    VoiceRSS.speech({
        key: 'd8d686a94f56470ebdccc67d0d0efb4d',
        src: joke,
        hl: 'en-us',
        v: 'Linda',
        r: 0, 
        c: 'mp3',
        f: '44khz_16bit_stereo',
        ssml: false
    });
}



const jokeAPI = 'https://v2.jokeapi.dev/joke/Any';
async function getJokes() {
    let joke='';
    try {
        const response = await fetch(jokeAPI);
       
        const singleJoke = await response.json();
      
        if(singleJoke.setup){
            joke = `${singleJoke.setup} .... ${singleJoke.delivery}`;
        }else{
            joke = singleJoke.joke;
        }
        tellJoke(joke);
    } catch (error) {
        console.log("Something Wrong", error)
    }
}




button.addEventListener('click', getJokes);